#define TINY_GSM_MODEM_SIM7600   // or A7670 if youâ€™re using that
#include <TinyGsmClient.h>
#include <SoftwareSerial.h>

// Define pins for GSM
#define RX_PIN 5   // Arduino RX â† GSM TX
#define TX_PIN 4   // Arduino TX â†’ GSM RX

SoftwareSerial SerialAT(RX_PIN, TX_PIN);
TinyGsm modem(SerialAT);

void setup() {
  Serial.begin(115200);
  SerialAT.begin(115200);
  delay(3000);

  Serial.println("ðŸ”¹ TinyGSM Modem Tester ðŸ”¹");
  Serial.println("--------------------------------");

  // Initialize modem
  Serial.println("â³ Initializing modem...");
  if (!modem.restart()) {
    Serial.println("âŒ Modem restart failed!");
    return;
  }

  // Get modem info
  String modemInfo = modem.getModemInfo();
  Serial.println("âœ… Modem Info: " + modemInfo);

  // Wait for network
  if (!modem.waitForNetwork(60000L)) {
    Serial.println("âŒ Network not found!");
    return;
  }

  Serial.println("ðŸ“¶ Network found!");

  // Print signal strength
  int signal = modem.getSignalQuality();
  Serial.println("ðŸ“¡ Signal Strength: " + String(signal));

  Serial.println("--------------------------------");
  Serial.println("Type AT commands below:");
}

void loop() {
  // Forward Serial Monitor â†’ GSM
  while (Serial.available()) {
    SerialAT.write(Serial.read());
  }

  // Forward GSM â†’ Serial Monitor
  while (SerialAT.available()) {
    Serial.write(SerialAT.read());
  }

  // Optional: print signal every 10 seconds
  static unsigned long lastCheck = 0;
  if (millis() - lastCheck > 10000) {
    int signal = modem.getSignalQuality();
    Serial.println("ðŸ“¶ Signal Strength: " + String(signal));
    lastCheck = millis();
  }
}
